{"version":3,"sources":["../dist-esnext/Battle.js"],"names":["startBattle","fieldConfig","field","isOver","openNearPositions","battle","pos","map","clickPosition","p","openAllField","col","endBattle","finalBattle","position","x","y","opened","isBomb","openedPos","nearBombs"],"mappings":";;;;;;;AAAA;;AACA,SAASA,WAAT,CAAqBC,WAArB,EAAkC;AAC9B,QAAMC,QAAQ,4BAAgBD,WAAhB,CAAd;AACA,WAAO,EAAEC,YAAF,EAASC,QAAQ,KAAjB,EAAP;AACH;AACD,SAASC,iBAAT,CAA2BC,MAA3B,EAAmCC,GAAnC,EAAwC;AACpC;AACA,8BAAcA,GAAd,EAAmBC,GAAnB,CAAuB;AAAA,eAAKC,cAAcH,MAAd,EAAsBI,CAAtB,CAAL;AAAA,KAAvB;AACA,WAAOJ,MAAP;AACH;AACD,SAASK,YAAT,CAAsBR,KAAtB,EAA6B;AACzB,WAAOA,MAAMK,GAAN,CAAU;AAAA,eAAOI,IAAIJ,GAAJ,CAAQ;AAAA,mBAAO,yBAAaD,GAAb,CAAP;AAAA,SAAR,CAAP;AAAA,KAAV,CAAP;AACH;AACD,SAASM,SAAT,CAAmBP,MAAnB,EAA2B;AACvB,QAAMQ,cAAcR,MAApB;AACAQ,gBAAYV,MAAZ,GAAqB,IAArB;AACAU,gBAAYX,KAAZ,GAAoBQ,aAAaG,YAAYX,KAAzB,CAApB;AACA,WAAOW,WAAP;AACH;AACD,SAASL,aAAT,CAAuBH,MAAvB,EAA+BS,QAA/B,EAAyC;AACrC,QAAI,CAAC,4BAAgBT,OAAOH,KAAvB,EAA8BY,QAA9B,CAAL,EACI,OAAOT,MAAP;AACJ,QAAMC,MAAMD,OAAOH,KAAP,CAAaY,SAASC,CAAtB,EAAyBD,SAASE,CAAlC,CAAZ;AACA,QAAIV,IAAIW,MAAR,EACI,OAAOZ,MAAP;AACJ,QAAIC,IAAIY,MAAR,EACI,OAAON,UAAUP,MAAV,CAAP;AACJ,QAAMc,YAAY,yBAAab,GAAb,CAAlB;AACA,QAAIa,UAAUC,SAAV,KAAwB,CAA5B,EACI,OAAOhB,kBAAkBC,MAAlB,EAA0Bc,SAA1B,CAAP;AACJ,WAAOd,MAAP;AACH;QACQL,W,GAAAA,W;QAAaQ,a,GAAAA,a;AACtB","file":"Battle.js","sourcesContent":["import { getInitialField, nearPositions, openPosition, positionIsValid } from './Field';\nfunction startBattle(fieldConfig) {\n    const field = getInitialField(fieldConfig);\n    return { field, isOver: false };\n}\nfunction openNearPositions(battle, pos) {\n    // TODO impure\n    nearPositions(pos).map(p => clickPosition(battle, p));\n    return battle;\n}\nfunction openAllField(field) {\n    return field.map(col => col.map(pos => openPosition(pos)));\n}\nfunction endBattle(battle) {\n    const finalBattle = battle;\n    finalBattle.isOver = true;\n    finalBattle.field = openAllField(finalBattle.field);\n    return finalBattle;\n}\nfunction clickPosition(battle, position) {\n    if (!positionIsValid(battle.field, position))\n        return battle;\n    const pos = battle.field[position.x][position.y];\n    if (pos.opened)\n        return battle;\n    if (pos.isBomb)\n        return endBattle(battle);\n    const openedPos = openPosition(pos);\n    if (openedPos.nearBombs === 0)\n        return openNearPositions(battle, openedPos);\n    return battle;\n}\nexport { startBattle, clickPosition };\n//# sourceMappingURL=Battle.js.map"]}
{"version":3,"sources":["../dist-esnext/Battle.js"],"names":["startBattle","fieldConfig","field","isOver","openNearPositions","battle","pos","last","map","clickPosition","p","openAllField","col","endBattle","position","autoOpen","x","y","opened","console","log","isBomb","openedPos","nearBombs","battleMarkPosition"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA,IAAMA,cAAc,SAAdA,WAAc,CAACC,WAAD,EAAiB;AACjC,QAAMC,QAAQ,4BAAgBD,WAAhB,CAAd;AACA,WAAO,EAAEC,YAAF,EAASC,QAAQ,KAAjB,EAAP;AACH,CAHD;AAIA,IAAMC,oBAAoB,SAApBA,iBAAoB,CAACC,MAAD,EAASC,GAAT;AAAA,WAAiB,gBAAEC,IAAF,CAAO,0BAAcD,GAAd,EAAmBE,GAAnB,CAAuB;AAAA,eAAKC,cAAcJ,MAAd,EAAsBK,CAAtB,EAAyB,IAAzB,CAAL;AAAA,KAAvB,CAAP,CAAjB;AAAA,CAA1B;AACA,IAAMC,eAAe,SAAfA,YAAe,CAACT,KAAD;AAAA,WAAWA,MAAMM,GAAN,CAAU;AAAA,eAAOI,IAAIJ,GAAJ,CAAQ;AAAA,mBAAO,yBAAaF,GAAb,CAAP;AAAA,SAAR,CAAP;AAAA,KAAV,CAAX;AAAA,CAArB;AACA,SAASO,SAAT,CAAmBR,MAAnB,EAA2B;AACvBA,WAAOF,MAAP,GAAgB,IAAhB;AACAE,WAAOH,KAAP,GAAeS,aAAaN,OAAOH,KAApB,CAAf;AACA,WAAOG,MAAP;AACH;AACD,IAAMI,gBAAgB,SAAhBA,aAAgB,CAACJ,MAAD,EAASS,QAAT,EAAmBC,QAAnB,EAAgC;AAClD,QAAI,CAAC,4BAAgBV,OAAOH,KAAvB,EAA8BY,QAA9B,CAAL,EACI,OAAOT,MAAP;AACJ,QAAMC,MAAMD,OAAOH,KAAP,CAAaY,SAASE,CAAtB,EAAyBF,SAASG,CAAlC,CAAZ;AACA,QAAIX,IAAIY,MAAR,EAAgB;AACZ,YAAI,CAACH,QAAL,EACII,QAAQC,GAAR,CAAY,kCAAZ;AACJ,eAAOf,MAAP;AACH;AACD,QAAIC,IAAIe,MAAR,EACI,OAAOR,UAAUR,MAAV,CAAP;AACJ,QAAMiB,YAAY,yBAAahB,GAAb,CAAlB;AACA,QAAIgB,UAAUC,SAAV,KAAwB,CAA5B,EACI,OAAOnB,kBAAkBC,MAAlB,EAA0BiB,SAA1B,CAAP;AACJ,WAAOjB,MAAP;AACH,CAfD;AAgBA,IAAMmB,qBAAqB,SAArBA,kBAAqB,CAACnB,MAAD,EAASS,QAAT,EAAsB;AAC7CK,YAAQC,GAAR,CAAY,gBAAZ;AACA,QAAI,CAAC,4BAAgBf,OAAOH,KAAvB,EAA8BY,QAA9B,CAAL,EACI,OAAOT,MAAP;AACJ,QAAIC,MAAMD,OAAOH,KAAP,CAAaY,SAASE,CAAtB,EAAyBF,SAASG,CAAlC,CAAV;AACA,QAAIX,IAAIY,MAAR,EACI,OAAOb,MAAP;AACJ,QAAIC,IAAIe,MAAR,EACI,OAAOR,UAAUR,MAAV,CAAP;AACJ;AACAc,YAAQC,GAAR,CAAY,YAAZ,EAA0Bd,GAA1B;AACAA,UAAM,yBAAaA,GAAb,CAAN;AACAa,YAAQC,GAAR,CAAY,WAAZ,EAAyBd,GAAzB;AACA,WAAOD,MAAP;AACH,CAdD;QAeSL,W,GAAAA,W;QAAaS,a,GAAAA,a;QAAee,kB,GAAAA,kB;AACrC","file":"Battle.js","sourcesContent":["import R from 'ramda';\nimport { getInitialField, markPosition, nearPositions, openPosition, positionIsValid } from './Field';\nconst startBattle = (fieldConfig) => {\n    const field = getInitialField(fieldConfig);\n    return { field, isOver: false };\n};\nconst openNearPositions = (battle, pos) => R.last(nearPositions(pos).map(p => clickPosition(battle, p, true)));\nconst openAllField = (field) => field.map(col => col.map(pos => openPosition(pos)));\nfunction endBattle(battle) {\n    battle.isOver = true;\n    battle.field = openAllField(battle.field);\n    return battle;\n}\nconst clickPosition = (battle, position, autoOpen) => {\n    if (!positionIsValid(battle.field, position))\n        return battle;\n    const pos = battle.field[position.x][position.y];\n    if (pos.opened) {\n        if (!autoOpen)\n            console.log('Position Already open, try again');\n        return battle;\n    }\n    if (pos.isBomb)\n        return endBattle(battle);\n    const openedPos = openPosition(pos);\n    if (openedPos.nearBombs === 0)\n        return openNearPositions(battle, openedPos);\n    return battle;\n};\nconst battleMarkPosition = (battle, position) => {\n    console.log('MARKPOS BATTLE');\n    if (!positionIsValid(battle.field, position))\n        return battle;\n    let pos = battle.field[position.x][position.y];\n    if (pos.opened)\n        return battle;\n    if (pos.isBomb)\n        return endBattle(battle);\n    // pos.marked++;\n    console.log('BEFORE POS', pos);\n    pos = markPosition(pos);\n    console.log('AFTER POS', pos);\n    return battle;\n};\nexport { startBattle, clickPosition, battleMarkPosition };\n//# sourceMappingURL=Battle.js.map"]}
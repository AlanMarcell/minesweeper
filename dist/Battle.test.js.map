{"version":3,"sources":["../dist-esnext/Battle.test.js"],"names":["battle","Field","describe","fieldConfig","before","bombs","width","height","it","result","startBattle","newBattle","opened","invalidPos","x","y","clickPosition","allPositions","field","positions","map","p","should","be","equal","valid","not","openedFirst","openedSecond","result2","valid2","find","propEq","clicked","marked","battleMarkPosition"],"mappings":"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","file":"Battle.test.js","sourcesContent":["import { ok } from 'ptz-assert';\nimport R from 'ramda';\nimport * as battle from './Battle';\nimport * as Field from './Field';\ndescribe('Battle', () => {\n    describe('startBattle', () => {\n        let fieldConfig;\n        before('Set field config', () => {\n            fieldConfig = {\n                bombs: 9, width: 9, height: 9\n            };\n        });\n        it('returns new battle', () => {\n            const result = battle.startBattle(fieldConfig);\n            ok(result);\n        });\n    });\n    describe('clickPosition', () => {\n        let fieldConfig;\n        before('Set field config', () => {\n            fieldConfig = {\n                bombs: 9, width: 9, height: 9\n            };\n        });\n        it('shold not open if position is invalid ', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let opened = 0;\n            const invalidPos = { x: -1, y: -1 };\n            const result = battle.clickPosition(newBattle, invalidPos);\n            Field.allPositions(result.field.positions).map(p => p.opened ? opened++ : opened);\n            opened.should.be.equal(0);\n        });\n        it('shold open if position is valid ', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let opened = 0;\n            const valid = { x: 1, y: 1 };\n            const result = battle.clickPosition(newBattle, valid);\n            Field.allPositions(result.field.positions).map(p => p.opened ? opened++ : opened);\n            opened.should.not.be.equal(0);\n        });\n        it('shold not open if position is open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let openedFirst = 0;\n            let openedSecond = 0;\n            const valid = { x: 1, y: 1 };\n            const result = battle.clickPosition(newBattle, valid);\n            const result2 = battle.clickPosition(result, valid);\n            Field.allPositions(result.field.positions).map(p => p.opened ? openedFirst++ : openedFirst);\n            Field.allPositions(result2.field.positions).map(p => p.opened ? openedSecond++ : openedSecond);\n            openedFirst.should.be.equal(openedSecond);\n        });\n        it('shold open if position is not open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let openedFirst = 0;\n            let openedSecond = 0;\n            const valid = { x: 1, y: 1 };\n            const result = battle.clickPosition(newBattle, valid);\n            let valid2;\n            valid2 = R.find(R.propEq('opened', false), Field.allPositions(result.field.positions));\n            Field.allPositions(result.field.positions).map(p => p.opened ? openedFirst++ : openedFirst);\n            const result2 = battle.clickPosition(result, valid2);\n            Field.allPositions(result2.field.positions).map(p => p.opened ? openedSecond++ : openedSecond);\n            openedFirst.should.be.not.equal(openedSecond);\n        });\n        it('shold open if position is not marked', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const clicked = battle.clickPosition(newBattle, valid);\n            clicked.field[valid.x][valid.y].opened.should.be.equal(true);\n            clicked.field[valid.x][valid.y].marked.should.be.equal(0);\n            ok(clicked);\n        });\n        it('shold not open if position is marked', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const marked = battle.battleMarkPosition(newBattle, valid);\n            const clicked = battle.clickPosition(marked, valid);\n            clicked.field[valid.x][valid.y].opened.should.be.equal(false);\n            clicked.field[valid.x][valid.y].marked.should.be.equal(1);\n            ok(clicked);\n        });\n    });\n    describe('markPosition', () => {\n        let fieldConfig;\n        before('Set field config', () => {\n            fieldConfig = {\n                bombs: 9, width: 9, height: 9\n            };\n        });\n        it('should mark pos if not open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const result = battle.battleMarkPosition(newBattle, valid);\n            result.field[valid.x][valid.y].marked.should.be.equal(1);\n            ok(result);\n        });\n        it('should not mark pos if open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const clicked = battle.clickPosition(newBattle, valid);\n            const marked = battle.battleMarkPosition(clicked, valid);\n            marked.field[valid.x][valid.y].opened.should.be.equal(true);\n            marked.field[valid.x][valid.y].marked.should.be.equal(0);\n            ok(marked);\n        });\n    });\n});\n//# sourceMappingURL=Battle.test.js.map"]}
{"version":3,"sources":["../dist-esnext/Battle.test.js"],"names":["battle","Field","describe","fieldConfig","before","bombs","width","height","it","result","startBattle","newBattle","opened","invalidPos","x","y","resultBattle","clickPosition","allPositions","field","map","p","should","be","equal","valid","not","openedFirst","openedSecond","result2","valid2","find","propEq","clicked","marked","battleMarkPosition","console","log","openNearPositions","nearPositions","validNearPos","length"],"mappings":";;AAAA;;AACA;;;;AACA;;IAAYA,M;;AACZ;;IAAYC,K;;;;;;AACZC,SAAS,QAAT,EAAmB,MAAM;AACrBA,aAAS,aAAT,EAAwB,MAAM;AAC1B,YAAIC,WAAJ;AACAC,eAAO,kBAAP,EAA2B,MAAM;AAC7BD,0BAAc;AACVE,uBAAO,CADG,EACAC,OAAO,CADP,EACUC,QAAQ;AADlB,aAAd;AAGH,SAJD;AAKAC,WAAG,oBAAH,EAAyB,MAAM;AAC3B,kBAAMC,SAAST,OAAOU,WAAP,CAAmBP,WAAnB,CAAf;AACA,+BAAGM,MAAH;AACH,SAHD;AAIH,KAXD;AAYAP,aAAS,eAAT,EAA0B,MAAM;AAC5B,YAAIC,WAAJ;AACAC,eAAO,kBAAP,EAA2B,MAAM;AAC7BD,0BAAc;AACVE,uBAAO,CADG,EACAC,OAAO,CADP,EACUC,QAAQ;AADlB,aAAd;AAGH,SAJD;AAKAC,WAAG,wCAAH,EAA6C,MAAM;AAC/C,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,gBAAIS,SAAS,CAAb;AACA,kBAAMC,aAAa,EAAEC,GAAG,CAAC,CAAN,EAASC,GAAG,CAAC,CAAb,EAAnB;AACA,kBAAMC,eAAehB,OAAOiB,aAAP,CAAqBN,SAArB,EAAgCE,UAAhC,CAArB;AACAZ,kBAAMiB,YAAN,CAAmBF,aAAaG,KAAhC,EAAuCC,GAAvC,CAA2CC,KAAKA,EAAET,MAAF,GAAWA,QAAX,GAAsBA,MAAtE;AACAA,mBAAOU,MAAP,CAAcC,EAAd,CAAiBC,KAAjB,CAAuB,CAAvB;AACH,SAPD;AAQAhB,WAAG,kCAAH,EAAuC,MAAM;AACzC,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,gBAAIS,SAAS,CAAb;AACA,kBAAMa,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMC,eAAehB,OAAOiB,aAAP,CAAqBN,SAArB,EAAgCc,KAAhC,CAArB;AACAxB,kBAAMiB,YAAN,CAAmBF,aAAaG,KAAhC,EAAuCC,GAAvC,CAA2CC,KAAKA,EAAET,MAAF,GAAWA,QAAX,GAAsBA,MAAtE;AACA;AACAA,mBAAOU,MAAP,CAAcI,GAAd,CAAkBH,EAAlB,CAAqBC,KAArB,CAA2B,CAA3B;AACH,SARD;AASAhB,WAAG,oCAAH,EAAyC,MAAM;AAC3C,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,gBAAIwB,cAAc,CAAlB;AACA,gBAAIC,eAAe,CAAnB;AACA,kBAAMH,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMN,SAAST,OAAOiB,aAAP,CAAqBN,SAArB,EAAgCc,KAAhC,CAAf;AACA,kBAAMI,UAAU7B,OAAOiB,aAAP,CAAqBR,MAArB,EAA6BgB,KAA7B,CAAhB;AACAxB,kBAAMiB,YAAN,CAAmBT,OAAOU,KAA1B,EAAiCC,GAAjC,CAAqCC,KAAKA,EAAET,MAAF,GAAWe,aAAX,GAA2BA,WAArE;AACA1B,kBAAMiB,YAAN,CAAmBW,QAAQV,KAA3B,EAAkCC,GAAlC,CAAsCC,KAAKA,EAAET,MAAF,GAAWgB,cAAX,GAA4BA,YAAvE;AACAD,wBAAYL,MAAZ,CAAmBC,EAAnB,CAAsBC,KAAtB,CAA4BI,YAA5B;AACH,SAVD;AAWApB,WAAG,oCAAH,EAAyC,MAAM;AAC3C,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,gBAAIwB,cAAc,CAAlB;AACA,gBAAIC,eAAe,CAAnB;AACA,kBAAMH,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMN,SAAST,OAAOiB,aAAP,CAAqBN,SAArB,EAAgCc,KAAhC,CAAf;AACA,gBAAIK,MAAJ;AACAA,qBAAS,gBAAEC,IAAF,CAAO,gBAAEC,MAAF,CAAS,QAAT,EAAmB,KAAnB,CAAP,EAAkC/B,MAAMiB,YAAN,CAAmBT,OAAOU,KAA1B,CAAlC,CAAT;AACAlB,kBAAMiB,YAAN,CAAmBT,OAAOU,KAA1B,EAAiCC,GAAjC,CAAqCC,KAAKA,EAAET,MAAF,GAAWe,aAAX,GAA2BA,WAArE;AACA,kBAAME,UAAU7B,OAAOiB,aAAP,CAAqBR,MAArB,EAA6BqB,MAA7B,CAAhB;AACA7B,kBAAMiB,YAAN,CAAmBW,QAAQV,KAA3B,EAAkCC,GAAlC,CAAsCC,KAAKA,EAAET,MAAF,GAAWgB,cAAX,GAA4BA,YAAvE;AACAD,wBAAYL,MAAZ,CAAmBC,EAAnB,CAAsBG,GAAtB,CAA0BF,KAA1B,CAAgCI,YAAhC;AACH,SAZD;AAaApB,WAAG,sCAAH,EAA2C,MAAM;AAC7C,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,kBAAMsB,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMkB,UAAUjC,OAAOiB,aAAP,CAAqBN,SAArB,EAAgCc,KAAhC,CAAhB;AACAQ,oBAAQd,KAAR,CAAcM,MAAMX,CAApB,EAAuBW,MAAMV,CAA7B,EAAgCH,MAAhC,CAAuCU,MAAvC,CAA8CC,EAA9C,CAAiDC,KAAjD,CAAuD,IAAvD;AACAS,oBAAQd,KAAR,CAAcM,MAAMX,CAApB,EAAuBW,MAAMV,CAA7B,EAAgCmB,MAAhC,CAAuCZ,MAAvC,CAA8CC,EAA9C,CAAiDC,KAAjD,CAAuD,CAAvD;AACA,+BAAGS,OAAH;AACH,SAPD;AAQAzB,WAAG,sCAAH,EAA2C,MAAM;AAC7C,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,kBAAMsB,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMmB,SAASlC,OAAOmC,kBAAP,CAA0BxB,SAA1B,EAAqCc,KAArC,CAAf;AACA,kBAAMQ,UAAUjC,OAAOiB,aAAP,CAAqBiB,MAArB,EAA6BT,KAA7B,CAAhB;AACAQ,oBAAQd,KAAR,CAAcM,MAAMX,CAApB,EAAuBW,MAAMV,CAA7B,EAAgCH,MAAhC,CAAuCU,MAAvC,CAA8CC,EAA9C,CAAiDC,KAAjD,CAAuD,KAAvD;AACAS,oBAAQd,KAAR,CAAcM,MAAMX,CAApB,EAAuBW,MAAMV,CAA7B,EAAgCmB,MAAhC,CAAuCZ,MAAvC,CAA8CC,EAA9C,CAAiDC,KAAjD,CAAuD,CAAvD;AACA,+BAAGS,OAAH;AACH,SARD;AASH,KAjED;AAkEA/B,aAAS,cAAT,EAAyB,MAAM;AAC3B,YAAIC,WAAJ;AACAC,eAAO,kBAAP,EAA2B,MAAM;AAC7BD,0BAAc;AACVE,uBAAO,CADG,EACAC,OAAO,CADP,EACUC,QAAQ;AADlB,aAAd;AAGH,SAJD;AAKAC,WAAG,6BAAH,EAAkC,MAAM;AACpC,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,kBAAMsB,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMN,SAAST,OAAOmC,kBAAP,CAA0BxB,SAA1B,EAAqCc,KAArC,CAAf;AACAhB,mBAAOU,KAAP,CAAaM,MAAMX,CAAnB,EAAsBW,MAAMV,CAA5B,EAA+BmB,MAA/B,CAAsCZ,MAAtC,CAA6CC,EAA7C,CAAgDC,KAAhD,CAAsD,CAAtD;AACA,+BAAGf,MAAH;AACH,SAND;AAOAD,WAAG,6BAAH,EAAkC,MAAM;AACpC,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,kBAAMsB,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMkB,UAAUjC,OAAOiB,aAAP,CAAqBN,SAArB,EAAgCc,KAAhC,CAAhB;AACA,kBAAMS,SAASlC,OAAOmC,kBAAP,CAA0BF,OAA1B,EAAmCR,KAAnC,CAAf;AACAS,mBAAOf,KAAP,CAAaM,MAAMX,CAAnB,EAAsBW,MAAMV,CAA5B,EAA+BH,MAA/B,CAAsCU,MAAtC,CAA6CC,EAA7C,CAAgDC,KAAhD,CAAsD,IAAtD;AACAU,mBAAOf,KAAP,CAAaM,MAAMX,CAAnB,EAAsBW,MAAMV,CAA5B,EAA+BmB,MAA/B,CAAsCZ,MAAtC,CAA6CC,EAA7C,CAAgDC,KAAhD,CAAsD,CAAtD;AACA,+BAAGU,MAAH;AACH,SARD;AASH,KAvBD;AAwBAhC,aAAS,mBAAT,EAA8B,MAAM;AAChC,YAAIC,WAAJ;AACAC,eAAO,kBAAP,EAA2B,MAAM;AAC7BgC,oBAAQC,GAAR,CAAY,kBAAZ;AACAlC,0BAAc;AACVE,uBAAO,CADG,EACAC,OAAO,CADP,EACUC,QAAQ;AADlB,aAAd;AAGH,SALD;AAMAC,WAAG,0BAAH,EAA+B,MAAM;AACjC,kBAAMG,YAAYX,OAAOU,WAAP,CAAmBP,WAAnB,CAAlB;AACA,kBAAMsB,QAAQ,EAAEX,GAAG,CAAL,EAAQC,GAAG,CAAX,EAAd;AACA,kBAAMN,SAAST,OAAOsC,iBAAP,CAAyB3B,SAAzB,EAAoCc,KAApC,CAAf;AACA,kBAAMc,gBAAgBtC,MAAMuC,YAAN,CAAmB/B,OAAOU,KAA1B,EAAiCM,KAAjC,CAAtB;AACA,gBAAIb,SAAS,CAAb;AACA2B,0BAAcnB,GAAd,CAAkBC,KAAK;AACnB,oBAAIZ,OAAOU,KAAP,CAAaE,EAAEP,CAAf,EAAkBO,EAAEN,CAApB,EAAuBH,MAA3B,EACIA;AACP,aAHD;AAIAA,mBAAOU,MAAP,CAAcC,EAAd,CAAiBC,KAAjB,CAAuBe,cAAcE,MAArC;AACH,SAXD;AAYH,KApBD;AAqBH,CA5HD;AA6HA","file":"Battle.test.js","sourcesContent":["import { ok } from 'ptz-assert';\nimport R from 'ramda';\nimport * as battle from './Battle';\nimport * as Field from './Field';\ndescribe('Battle', () => {\n    describe('startBattle', () => {\n        let fieldConfig;\n        before('Set field config', () => {\n            fieldConfig = {\n                bombs: 9, width: 9, height: 9\n            };\n        });\n        it('returns new battle', () => {\n            const result = battle.startBattle(fieldConfig);\n            ok(result);\n        });\n    });\n    describe('clickPosition', () => {\n        let fieldConfig;\n        before('Set field config', () => {\n            fieldConfig = {\n                bombs: 9, width: 9, height: 9\n            };\n        });\n        it('shold not open if position is invalid ', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let opened = 0;\n            const invalidPos = { x: -1, y: -1 };\n            const resultBattle = battle.clickPosition(newBattle, invalidPos);\n            Field.allPositions(resultBattle.field).map(p => p.opened ? opened++ : opened);\n            opened.should.be.equal(0);\n        });\n        it('shold open if position is valid ', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let opened = 0;\n            const valid = { x: 1, y: 1 };\n            const resultBattle = battle.clickPosition(newBattle, valid);\n            Field.allPositions(resultBattle.field).map(p => p.opened ? opened++ : opened);\n            // resultBattle.should.not.be.equal(newBattle);\n            opened.should.not.be.equal(0);\n        });\n        it('shold not open if position is open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let openedFirst = 0;\n            let openedSecond = 0;\n            const valid = { x: 1, y: 1 };\n            const result = battle.clickPosition(newBattle, valid);\n            const result2 = battle.clickPosition(result, valid);\n            Field.allPositions(result.field).map(p => p.opened ? openedFirst++ : openedFirst);\n            Field.allPositions(result2.field).map(p => p.opened ? openedSecond++ : openedSecond);\n            openedFirst.should.be.equal(openedSecond);\n        });\n        it('shold open if position is not open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            let openedFirst = 0;\n            let openedSecond = 0;\n            const valid = { x: 1, y: 1 };\n            const result = battle.clickPosition(newBattle, valid);\n            let valid2;\n            valid2 = R.find(R.propEq('opened', false), Field.allPositions(result.field));\n            Field.allPositions(result.field).map(p => p.opened ? openedFirst++ : openedFirst);\n            const result2 = battle.clickPosition(result, valid2);\n            Field.allPositions(result2.field).map(p => p.opened ? openedSecond++ : openedSecond);\n            openedFirst.should.be.not.equal(openedSecond);\n        });\n        it('shold open if position is not marked', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const clicked = battle.clickPosition(newBattle, valid);\n            clicked.field[valid.x][valid.y].opened.should.be.equal(true);\n            clicked.field[valid.x][valid.y].marked.should.be.equal(0);\n            ok(clicked);\n        });\n        it('shold not open if position is marked', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const marked = battle.battleMarkPosition(newBattle, valid);\n            const clicked = battle.clickPosition(marked, valid);\n            clicked.field[valid.x][valid.y].opened.should.be.equal(false);\n            clicked.field[valid.x][valid.y].marked.should.be.equal(1);\n            ok(clicked);\n        });\n    });\n    describe('markPosition', () => {\n        let fieldConfig;\n        before('Set field config', () => {\n            fieldConfig = {\n                bombs: 9, width: 9, height: 9\n            };\n        });\n        it('should mark pos if not open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const result = battle.battleMarkPosition(newBattle, valid);\n            result.field[valid.x][valid.y].marked.should.be.equal(1);\n            ok(result);\n        });\n        it('should not mark pos if open', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 1, y: 1 };\n            const clicked = battle.clickPosition(newBattle, valid);\n            const marked = battle.battleMarkPosition(clicked, valid);\n            marked.field[valid.x][valid.y].opened.should.be.equal(true);\n            marked.field[valid.x][valid.y].marked.should.be.equal(0);\n            ok(marked);\n        });\n    });\n    describe('openNearPositions', () => {\n        let fieldConfig;\n        before('Set field config', () => {\n            console.log('Set field config');\n            fieldConfig = {\n                bombs: 3, width: 3, height: 3\n            };\n        });\n        it('should openNearPositions', () => {\n            const newBattle = battle.startBattle(fieldConfig);\n            const valid = { x: 2, y: 2 };\n            const result = battle.openNearPositions(newBattle, valid);\n            const nearPositions = Field.validNearPos(result.field, valid);\n            let opened = 0;\n            nearPositions.map(p => {\n                if (result.field[p.x][p.y].opened)\n                    opened++;\n            });\n            opened.should.be.equal(nearPositions.length);\n        });\n    });\n});\n//# sourceMappingURL=Battle.test.js.map"]}
{"version":3,"sources":["../dist-esnext/Battle.test.js"],"names":["battle","Field","describe","fieldConfig","before","bombs","width","height","it","result","startBattle","newBattle","opened","invalidPos","x","y","clickPosition","allPositions","field","map","p","should","be","equal","valid","not","openedFirst","openedSecond","result2","valid2","find","propEq","clicked","marked","battleMarkPosition"],"mappings":"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","file":"Battle.test.js","sourcesContent":["import { ok } from 'ptz-assert';\r\nimport R from 'ramda';\r\nimport * as battle from './Battle';\r\nimport * as Field from './Field';\r\ndescribe('Battle', () => {\r\n    describe('startBattle', () => {\r\n        let fieldConfig;\r\n        before('Set field config', () => {\r\n            fieldConfig = {\r\n                bombs: 9, width: 9, height: 9\r\n            };\r\n        });\r\n        it('returns new battle', () => {\r\n            const result = battle.startBattle(fieldConfig);\r\n            ok(result);\r\n        });\r\n    });\r\n    describe('clickPosition', () => {\r\n        let fieldConfig;\r\n        before('Set field config', () => {\r\n            fieldConfig = {\r\n                bombs: 9, width: 9, height: 9\r\n            };\r\n        });\r\n        it('shold not open if position is invalid ', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            let opened = 0;\r\n            const invalidPos = { x: -1, y: -1 };\r\n            const result = battle.clickPosition(newBattle, invalidPos);\r\n            Field.allPositions(result.field).map(p => p.opened ? opened++ : opened);\r\n            opened.should.be.equal(0);\r\n        });\r\n        it('shold open if position is valid ', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            let opened = 0;\r\n            const valid = { x: 1, y: 1 };\r\n            const result = battle.clickPosition(newBattle, valid);\r\n            Field.allPositions(result.field).map(p => p.opened ? opened++ : opened);\r\n            opened.should.not.be.equal(0);\r\n        });\r\n        it('shold not open if position is open', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            let openedFirst = 0;\r\n            let openedSecond = 0;\r\n            const valid = { x: 1, y: 1 };\r\n            const result = battle.clickPosition(newBattle, valid);\r\n            const result2 = battle.clickPosition(result, valid);\r\n            Field.allPositions(result.field).map(p => p.opened ? openedFirst++ : openedFirst);\r\n            Field.allPositions(result2.field).map(p => p.opened ? openedSecond++ : openedSecond);\r\n            openedFirst.should.be.equal(openedSecond);\r\n        });\r\n        it('shold open if position is not open', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            let openedFirst = 0;\r\n            let openedSecond = 0;\r\n            const valid = { x: 1, y: 1 };\r\n            const result = battle.clickPosition(newBattle, valid);\r\n            let valid2;\r\n            valid2 = R.find(R.propEq('opened', false), Field.allPositions(result.field));\r\n            Field.allPositions(result.field).map(p => p.opened ? openedFirst++ : openedFirst);\r\n            const result2 = battle.clickPosition(result, valid2);\r\n            Field.allPositions(result2.field).map(p => p.opened ? openedSecond++ : openedSecond);\r\n            openedFirst.should.be.not.equal(openedSecond);\r\n        });\r\n        it('shold open if position is not marked', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            const valid = { x: 1, y: 1 };\r\n            const clicked = battle.clickPosition(newBattle, valid);\r\n            clicked.field[valid.x][valid.y].opened.should.be.equal(true);\r\n            clicked.field[valid.x][valid.y].marked.should.be.equal(0);\r\n            ok(clicked);\r\n        });\r\n        it('shold not open if position is marked', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            const valid = { x: 1, y: 1 };\r\n            const marked = battle.battleMarkPosition(newBattle, valid);\r\n            const clicked = battle.clickPosition(marked, valid);\r\n            clicked.field[valid.x][valid.y].opened.should.be.equal(false);\r\n            clicked.field[valid.x][valid.y].marked.should.be.equal(1);\r\n            ok(clicked);\r\n        });\r\n    });\r\n    describe('markPosition', () => {\r\n        let fieldConfig;\r\n        before('Set field config', () => {\r\n            fieldConfig = {\r\n                bombs: 9, width: 9, height: 9\r\n            };\r\n        });\r\n        it('should mark pos if not open', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            const valid = { x: 1, y: 1 };\r\n            const result = battle.battleMarkPosition(newBattle, valid);\r\n            result.field[valid.x][valid.y].marked.should.be.equal(1);\r\n            ok(result);\r\n        });\r\n        it('should not mark pos if open', () => {\r\n            const newBattle = battle.startBattle(fieldConfig);\r\n            const valid = { x: 1, y: 1 };\r\n            const clicked = battle.clickPosition(newBattle, valid);\r\n            const marked = battle.battleMarkPosition(clicked, valid);\r\n            marked.field[valid.x][valid.y].opened.should.be.equal(true);\r\n            marked.field[valid.x][valid.y].marked.should.be.equal(0);\r\n            ok(marked);\r\n        });\r\n    });\r\n});\r\n//# sourceMappingURL=Battle.test.js.map"]}